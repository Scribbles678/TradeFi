import{d as t}from"../../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@iconify/utils";import"node:crypto";import"consola";import"node:url";import"ipx";import"node:fs";import"node:path";const e=t((async t=>{try{const t=await $fetch("/api/balance/aster-positions");console.log("Crypto-data: Aster positions response:",t);const e=t.success?t.positions:[];console.log("Crypto-data: Aster positions count:",e.length);const s=await $fetch("/api/balance/aster"),o=s.success?s.balance:0,r=e.reduce(((t,e)=>t+(e.unrealized_pnl_usd||0)),0),a=e.map(((t,e)=>({id:`aster_${t.id}`,symbol:t.symbol,side:t.side,entry_price:t.entry_price,current_price:t.current_price,quantity:t.quantity,pnl_usd:t.unrealized_pnl_usd,is_winner:t.unrealized_pnl_usd>0,exit_time:(new Date).toISOString(),exchange:"aster",asset_class:"crypto"}))),n=r,i=a.filter((t=>t.is_winner)).length,c=a.length>0?i/a.length*100:0,p=a.map(((t,e)=>({date:(new Date).toLocaleDateString(),cumulative_pnl:t.pnl_usd})));return{success:!0,positions:e,trades:a,stats:{todayPnL:parseFloat(n.toFixed(2)),winRate:parseFloat(c.toFixed(2)),totalTrades:a.length},chartData:p,balance:o}}catch(t){return console.error("Error fetching crypto data:",t),{success:!1,positions:[],trades:[],stats:{todayPnL:0,winRate:0,totalTrades:0},chartData:[],balance:0,error:t instanceof Error?t.message:String(t)}}}));export{e as default};
//# sourceMappingURL=crypto-data.mjs.map
