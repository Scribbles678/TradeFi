import{d as e,r as s}from"../../../_/nitro.mjs";import{b as t,c as r}from"../../../_/supabase.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@iconify/utils";import"node:crypto";import"consola";import"node:url";import"ipx";import"node:fs";import"node:path";import"@supabase/supabase-js";const i=e((async e=>{try{const i=await s(e);if(i.symbol){console.log("Saving single trade:",i.symbol);const e={symbol:i.symbol,side:i.side,asset_class:i.asset_class||"crypto",exchange:i.exchange||"aster",entry_price:i.entry_price,entry_time:i.entry_time,exit_price:i.exit_price,exit_time:i.exit_time,quantity:i.quantity,position_size_usd:i.position_size_usd,stop_loss_price:i.stop_loss_price||null,take_profit_price:i.take_profit_price||null,stop_loss_percent:i.stop_loss_percent||null,take_profit_percent:i.take_profit_percent||null,pnl_usd:i.pnl_usd,pnl_percent:i.pnl_percent,is_winner:i.is_winner,exit_reason:i.exit_reason||null,order_id:i.order_id||null,notes:i.notes||null},s=await t(e);return s?{success:!0,trade:s,message:"Trade saved successfully"}:{success:!1,error:"Failed to save trade"}}if(Array.isArray(i)){console.log(`Saving ${i.length} trades`);const e=i.map((e=>({symbol:e.symbol,side:e.side,asset_class:e.asset_class||"crypto",exchange:e.exchange||"aster",entry_price:e.entry_price,entry_time:e.entry_time,exit_price:e.exit_price,exit_time:e.exit_time,quantity:e.quantity,position_size_usd:e.position_size_usd,stop_loss_price:e.stop_loss_price||null,take_profit_price:e.take_profit_price||null,stop_loss_percent:e.stop_loss_percent||null,take_profit_percent:e.take_profit_percent||null,pnl_usd:e.pnl_usd,pnl_percent:e.pnl_percent,is_winner:e.is_winner,exit_reason:e.exit_reason||null,order_id:e.order_id||null,notes:e.notes||null}))),s=await r(e);return s?{success:!0,trades:s,count:s.length,message:`${s.length} trades saved successfully`}:{success:!1,error:"Failed to save trades"}}return{success:!1,error:"Invalid request format. Expected single trade object or array of trades."}}catch(e){return console.error("Error in /api/trades/save:",e),{success:!1,error:"Internal server error",details:e instanceof Error?e.message:"Unknown error"}}}));export{i as default};
//# sourceMappingURL=save.mjs.map
